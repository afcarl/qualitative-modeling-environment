Raphael.fn.prediction=function(a,b,c,d,e){if(b==null){var f=this.outline(c,d);f.id=a;f.start={name:"time",kind:"time"};f.end=c;f.explanations=e;f.kind=d;d=d.replace(/ /g,"");f.attr({opacity:1,stroke:this.colors[d+"Stroke"],"stroke-width":"4px"});f.fadeOut=function(){this.oo=this.attr("opacity");this.attr("opacity",0)};f.fadeIn=function(){if(this.oo==null||this.oo<1)this.oo=1;this.attr("opacity",1)};f.redraw=function(){var a=this.paper.outline(this.end,this.kind);this.attr("path",a.attr("path"));a.remove();this.toFront()};f.click(function(){clickPred(this)});c.assoc[0].prediction=f;return f}var g=this.line(b,c);g.id=a;g.start=b;g.end=c;g.kind=d;g.explanations=e;d=d.replace(/ /g,"");g.attr({stroke:this.colors[d+"Stroke"],opacity:.3,"stroke-width":"8px"});g.coords=function(){var a=this.attr("path");return{x1:a[0][1],y1:a[0][2],x2:a[1][1],y2:a[1][2]}};g.drawDot=function(){var a=this.paper.circle(this.coords().x1,this.coords().y1,5);a.attr({fill:this.paper.colors[d+"Stroke"],stroke:"transparent",opacity:.8});a.parent=this;a.transport=function(){this.parent.attr("opacity")>0&&this.attr("opacity")==0&&this.attr("opacity",.8);this.attr({cx:this.parent.coords().x1,cy:this.parent.coords().y1}).animateAlong(this.parent,1500,!1,function(){this.transport()})};this.dot=a;a.transport()};g.fadeOut=function(){this.oo=.4;this.attr("opacity",0)};g.fadeIn=function(){this.attr("opacity",this.oo)};g.redraw=function(){var a=this.paper.line(this.start,this.end);this.attr("path",a.attr("path"));this.toFront();this.start.toFront();this.start.text.toFront();this.end.toFront();this.end.text.toFront();a.remove()};g.click(function(a){clickPred(g)});return g};Raphael.fn.drawPredictions=function(a){for(var b in a){var c=a[b];c.from=c.from.toLowerCase();c.from=c.from.replace(/-/g," ");c.to=c.to.toLowerCase();c.to=c.to.replace(/-/g," ");var d=this.relShapes[c.from],e=this.relShapes[c.to],f=parseInt(c.id.replace("p","")),g=c.direction;g=g.toLowerCase();g=g.replace(/-/g," ");var h=this.prediction(f,d,e,g,c.paths);h.toFront();if(d!=null){d.links.push(h);h.start.toFront();h.start.text.toFront()}e.links.push(h);h.end.toFront();h.end.text.toFront();this.addPrediction(h)}};Raphael.fn.getPredictions=function(){var a="../text/?model="+this.model+"&type=predictions",b=[],c=[],d=[],e=this;for(var f in this.allShapes){var g=this.allShapes[f],h=modelPaper.allShapes[f];if(g.disabled){b.push(g.id);var i=0;for(i=0;i<h.links.length;i++)c.push(h.links[i].id);var j=0;for(j=0;j<g.links.length;j++)d.push(g.links[j].id)}}var k=b.join(",");k.length>0&&(a+="&excludeShapes="+k);var l=c.join(",");l.length>0&&(a+="&excludeLinks="+l);var m=d.join(",");m.length>0&&(a+="&excludeFacts="+m);$.get(a,function(a){var b=$("<div />").addClass("group"),c=$("<h1 />").html("Predictions"),d=$("<div />").attr("id","predictions");b.html(c).append(d);$("#left2").append(b);e.generatedPredictions=!0;e.drawPredictions(a)})};
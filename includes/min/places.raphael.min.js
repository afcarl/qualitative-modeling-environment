Raphael.fn.place=function(a,b,c,d,e,f){var g=14;c*=zoom;d*=zoom;e*=zoom;f*=zoom;if(e<20||e==null)e=20;if(f<20||f==null)f=50;if(c<10||c==null)c=10;if(d<10||d==null)d=10;var h=this.rect(c,d,e,f,2),i=this.text(this.center(h).cx,d+g,b),j=this.set();h.id=a;h.name=b;h.kind="place";var k=8,l=this.circle(this.anchors(h).se.x-1.5*k,this.anchors(h).se.y-1.5*k,k);i.attr({fill:"#222",font:g+"px Signika Negative"});h.attr({stroke:this.colors.placeStroke,fill:this.colors.placeFill,"stroke-width":"2px",opacity:1});l.attr({stroke:this.colors.placeStroke,fill:this.colors.placeFill,"stroke-width":"2px",opacity:1});h.getPair=function(){var a;this.paper.showFacts?a=modelPaper.allShapes[this.id]:a=factPaper.allShapes[this.id];return a};h.move=placeDrag().move;h.start=placeDrag().start;h.end=placeDrag().end;h.save=saveShape;h.text=i;h.handle=l;h.children=j;i.parent=h;l.parent=h;l.move=handleDrag().move;l.start=handleDrag().start;l.end=handleDrag().end;h.drag(h.move,h.start,h.end);l.drag(l.move,l.start,l.end);return h};Raphael.fn.drawPlaces=function(a){for(var b in a){var c=a[b];c.x=parseInt(c.x);c.y=parseInt(c.y);c.width=parseInt(c.width);c.height=parseInt(c.height);if(c.width+50>=this.width){this.setSize(c.width+50,this.height);$(this.canvas).parent().css("min-width",c.width+50)}if(c.height+50>=this.height){this.setSize(this.width,c.height+50);$(this.canvas).parent().css("min-height",c.height+50)}var d=parseInt(c.location),e=parseInt(c.id),f=this.place(e,c.name,c.x,c.y,c.width,c.height);this.allShapes[e]=f;this.allPlaces[e]=f;if(d!=0){this.allShapes[d].children.push(f);f.parent=this.allShapes[d];if(this.showFacts){var g=this.allShapes[d].name;this.relShapes[c.name.toLowerCase()+"@"+g.toLowerCase()]=f}}this.showFacts||this.addPlace(f)}};Raphael.fn.getPlaces=function(){var a="SELECT e.*, p.* FROM entity e, placement p WHERE e.id=p.entity AND e.kind=:kind AND e.model=:model",b={":kind":"place",":model":this.model},c=this;$.post(this.qUrl,{query:a,data:b},function(a){c.drawPlaces(a);c.getEntities()})};